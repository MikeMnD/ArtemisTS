var __extends=this.__extends||function(n,t){function i(){this.constructor=n}i.prototype=t.prototype,n.prototype=new i};define(["require","exports","core/Manager","core/utils/Bag"],function(n,t,i,r){var f=i,u=r,e=function(n){function t(){n.call(this),this._className="ComponentManager",this._componentsByType=new u.Bag,this._deleted=new u.Bag}return __extends(t,n),t.prototype.initialize=function(){},t.prototype.removeComponentsOfEntity=function(n){for(var i=n.getComponentBits(),t=i.nextSetBit(0);t>=0;t=i.nextSetBit(t+1))this._componentsByType.get(t).set(n.getId(),null);i.clear()},t.prototype.addComponent=function(n,t,i){var r=this._componentsByType.get(t.getIndex());r==null&&(r=new u.Bag,this._componentsByType.set(t.getIndex(),r)),r.set(n.getId(),i),n.getComponentBits().set(t.getIndex())},t.prototype.removeComponent=function(n,t){n.getComponentBits().get(t.getIndex())&&(this._componentsByType.get(t.getIndex()).set(n.getId(),null),n.getComponentBits().clear(t.getIndex()))},t.prototype.getComponentsByType=function(n){var t;return t=this._componentsByType.get(n.getIndex()),t==null&&(t=new u.Bag,this._componentsByType.set(n.getIndex(),t)),t},t.prototype.getComponent=function(n,t){var i=this._componentsByType.get(t.getIndex());return i!=null?i.get(n.getId()):null},t.prototype.getComponentsFor=function(n,t){for(var r=n.getComponentBits(),i=r.nextSetBit(0);i>=0;i=r.nextSetBit(i+1))t.add(this._componentsByType.get(i).get(n.getId()));return t},t}(f.Manager);t.ComponentManager=e})